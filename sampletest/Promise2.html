<html>

    <body>

        <script>

            //Promiseインスタンスの取得
            const instance = new Promise( asyncHandler );   //引数には非同期処理を行う関数を指定

            //非同期処理を行う関数
            function asyncHandler( resolve , reject ){  //JSエンジンによって特殊な値が渡されてくる。変数名は任意でOK
                setTimeout( () => {
                    if( true ){
                        resolve( data );    //非同期処理に成功
                    }else{
                        reject( error );    //非同期処理に失敗
                    }
                });
            }

            //resolve,rejectは非同期処理の完了時点の状態に応じて使い分ける。
            //非同期処理に成功した場合はresolveを実行し、Promiseインスタンスのthenメソッドで登録した関数が実行される。
            //非同期処理に失敗した場合はrejectを実行、Promiseインスタンスのcatchで登録した関数が実行される。



            const prom = new Promise( asyncHandler );

            //------------
            //thenメソッド
            //------------
            
            //Promiseでthenメソッドを定義
            let thenprom = prom.then( successHandler ); //引数に、同期処理が成功した際に実施したい関数を指定

            //非同期処理に成功した時の処理
            function successHandler( data ){
                alert( "登録完了" );
            }

            //-----------
            //catch
            //-----------

            //Promiseでcatchメソッドを定義
            let catchProm = prom.catch( errorHandler );

            //非同期処理に失敗した時の処理
            function errorHandler( error ){
                alert( "登録失敗" );
            }

            //------------
            //finally
            //------------

            //Promiseのfinallyメソッドを定義
            let finallyProm = prom.finally( finallyHandler );

            //非同期処理の成否に関わらず実行される処理
            function finallyHandler(){
                console.log( "finally" );
            }

        </script>
        
    </body>

</html>